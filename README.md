# Fblthp Foundries

**Fblthp Foundries** is an innovative project dedicated to generating new and unique Magic: The Gathering cards using a combination of AI models. Our pipeline covers every step of the process, from text generation to final card rendering, offering customizable options based on user preferences.

## Generative Pipeline Overview

### Text Generation

We offer two pathways for generating card text:

- **GPT-4o-mini:** Utilizes OpenAI's API to generate card themes, names, and fine-tuned text outputs. The structured text is then parsed and prepared for the next stage in the pipeline.
  - *Estimated cost per card: < $0.001*

- **Fine-tuned GPT-2 Model:** Trained on a comprehensive corpus of existing MTG cards, this model employs custom tokenization and XML-like preprocessing to accurately generate card text. The output is parsed and forwarded to the next stage.
  - *Cost per card: $0* (assuming local execution)

### Image Prompt Generation

We provide two methods for generating image prompts:

- **GPT-4o-mini:** Uses the generated card text to create a detailed art prompt suitable for generating card art.
  - *Estimated cost per card: < $0.001*

- **Local Script:** Extracts relevant details from the card and assembles them into a prompt for art generation.
  - *Cost per card: $0*

### Image Generation

We support two methods for generating card art:

- **DALL-E:** High-quality images are generated via the OpenAI API using the previously created art prompt.
  - *Cost per card: $0.04 for 1024x1024, $0.08 for 1792x1024*

- **Stable Diffusion 3:** Uses open-source weights to generate images locally, ideal for those with access to a capable GPU.
  - *Cost per card: $0* (local GPU required)

### Card Rendering

The final step in the pipeline involves rendering the card:

- **Proxyshop:** Utilizes Photoshop plugins and templates from Proxyshop to create the final card image. This rendering is controlled by a separate thread so the main card generation can continue. This method requires a valid Photoshop installation but is otherwise free.
  - *Cost: Free* (with Photoshop)

## Examples

Here are some examples of cards generated by Fblthp Foundries:

<table>
  <tr>
    <td><img src="./examples/Azure%20Skyweaver%20(Borderless)%20[WAR]%20{42}.jpg" alt="Azure Skyweaver" width="300"/></td>
    <td><img src="./examples/Righteous%20Arbiter%20(Borderless)%20[WAR]%20{42}.jpg" alt="Righteous Arbiter" width="300"/></td>
  </tr>
  <tr>
    <td><img src="./examples/Spectral%20Informant%20(Borderless)%20[WAR]%20{42}.jpg" alt="Spectral Informant" width="300"/></td>
    <td><img src="./examples/Verdant%20Kavu%20(Borderless)%20[WAR]%20{42}.jpg" alt="Verdant Kavu" width="300"/></td>
  </tr>
</table>

## Installation Instructions

To get started with Fblthp Foundries, follow these steps:

1. **Clone the Repository:**
   ```bash
   git clone https://github.com/Jacksowe000/FblthpFoundries.git
   cd fblthp-foundries/fblthp
   ```

2. **Install Dependencies:**
   ```bash
   pip install -r requirements.txt
   ```

3. **Set Up Constants:**
   - Rename the `constants_example.py` to `constants.py` and fill in the necessary fields (Proxyshop path, OpenAI API key if desired).

## Usage

To generate a single card as JSON, run the following command:

```bash
python dragonlordplacidusaxqueenofthefullmoon.py --iterations 1
```

You can also specify pipeline components, for example:

```bash
python dragonlordplacidusaxqueenofthefullmoon.py --generator gpt --extractor gpt
```

This command uses GPT-4o-mini for both generation and prompt extraction.

Art generation can be enabled with the `--gen_art` flag, and the art model can be chosen with the `--art_model` argument:

```bash
python dragonlordplacidusaxqueenofthefullmoon.py --generator gpt --extractor gpt --gen_art --art_model DALL-E
```

To run a full start-to-finish pipeline that generates and renders a batch of 5 cards, use:

```bash
python dragonlordplacidusaxqueenofthefullmoon.py --generator gpt --extractor gpt --gen_art --art_model DALL-E --insta_render --iterations 5
```

## Future Goals

We aim to enhance the balance of the generated cards and boost the overall creativity of the AI models.

## Technologies

- **PyTorch**
- **Stable Diffusion 3**
- **OpenAI API**
- **Proxyshop** (Photoshop extension for card rendering)
